import { BodyParser } from "../BodyParser";

describe("BodyParser", function () {
    const parser = new BodyParser()
    describe("urlencoded", function () {
        it("should parse urlencoded", function () {
            const result = parser.parse("application/x-www-form-urlencoded; charset=UTF-8", "id=5d78f04077b40a02383b296d&event=Dash+Page+Loaded&properties%5Bpath%5D=%2Fdashboard")
            expect(result).toEqual({
                id: '5d78f04077b40a02383b296d',
                event: "Dash Page Loaded",
                "properties[path]": "/dashboard"
            })
        })
    })
    describe("undefined", function () {
        it("should yield undefined for undefined", function () {
            const result = parser.parse()
            expect(result).toEqual(undefined)
        })
    })
    describe("json", function () {
        it("should parse json", function () {
            const result = parser.parse("application/hal+json; charset=utf-8", "{\"id\":\"GLI_1076\",\"route\":\"1076\",\"dir\":\"I\",\"colour\":\"#008837\",\"category\":\"Northeast Region\",\"services\":[{\"date\":\"2019-09-29\",\"linkDate\":\"09-29-2019\",\"startTime\":{\"dateTime\":\"2019-09-29 09:10:00\",\"hrs\":9,\"mins\":10},\"timetables\":[{\"arrive\":{\"dateTime\":\"2019-09-29 09:10:00\",\"hrs\":9,\"mins\":10},\"depart\":{\"dateTime\":\"2019-09-29 09:10:00\",\"hrs\":9,\"mins\":10},\"layover\":0,\"status\":null,\"timeZone\":\"America/New_York\",\"actualStatus\":3,\"duplicateCount\":0,\"eta\":{\"etaArrive\":{\"dateTime\":\"2019-09-29 10:49:00\",\"hrs\":10,\"mins\":49},\"etaDepart\":{\"dateTime\":\"2019-09-29 10:49:00\",\"hrs\":10,\"mins\":49},\"etaLayover\":0,\"arrive\":{\"dateTime\":\"2019-09-29 10:49:00\",\"hrs\":10,\"mins\":49},\"depart\":{\"dateTime\":\"2019-09-29 10:49:27\",\"hrs\":10,\"mins\":49},\"atStop\":false,\"late\":true,\"status\":\"visited\",\"timestamp\":\"2019-09-29 10:49:27 +0000\"},\"delayed\":false},{\"arrive\":{\"dateTime\":\"2019-09-29 10:00:00\",\"hrs\":10,\"mins\":0},\"depart\":{\"dateTime\":\"2019-09-29 10:00:00\",\"hrs\":10,\"mins\":0},\"layover\":0,\"status\":null,\"timeZone\":\"America/New_York\",\"actualStatus\":3,\"duplicateCount\":0,\"eta\":{\"etaArrive\":{\"dateTime\":\"2019-09-29 11:16:00\",\"hrs\":11,\"mins\":16},\"etaDepart\":{\"dateTime\":\"2019-09-29 11:16:00\",\"hrs\":11,\"mins\":16},\"etaLayover\":0,\"arrive\":{\"dateTime\":\"2019-09-29 11:15:58\",\"hrs\":11,\"mins\":15},\"depart\":{\"dateTime\":\"2019-09-29 11:29:28\",\"hrs\":11,\"mins\":29},\"atStop\":false,\"late\":true,\"status\":\"visited\",\"timestamp\":\"2019-09-29 11:15:58 +0000\"},\"delayed\":false},{\"arrive\":{\"dateTime\":\"2019-09-29 10:45:00\",\"hrs\":10,\"mins\":45},\"depart\":{\"dateTime\":\"2019-09-29 10:45:00\",\"hrs\":10,\"mins\":45},\"layover\":0,\"status\":null,\"timeZone\":\"America/New_York\",\"actualStatus\":3,\"duplicateCount\":0,\"eta\":{\"etaArrive\":{\"dateTime\":\"2019-09-29 12:02:00\",\"hrs\":12,\"mins\":2},\"etaDepart\":{\"dateTime\":\"2019-09-29 12:02:00\",\"hrs\":12,\"mins\":2},\"etaLayover\":0,\"arrive\":{\"dateTime\":\"2019-09-29 12:01:59\",\"hrs\":12,\"mins\":1},\"depart\":{\"dateTime\":\"2019-09-29 12:20:59\",\"hrs\":12,\"mins\":20},\"atStop\":false,\"late\":true,\"status\":\"visited\",\"timestamp\":\"2019-09-29 12:01:59 +0000\"},\"delayed\":false},{\"arrive\":{\"dateTime\":\"2019-09-29 12:20:00\",\"hrs\":12,\"mins\":20},\"depart\":{\"dateTime\":\"2019-09-29 12:20:00\",\"hrs\":12,\"mins\":20},\"layover\":0,\"status\":null,\"timeZone\":\"America/New_York\",\"actualStatus\":3,\"duplicateCount\":0,\"eta\":{\"etaArrive\":{\"dateTime\":\"2019-09-29 13:42:00\",\"hrs\":13,\"mins\":42},\"etaDepart\":{\"dateTime\":\"2019-09-29 13:42:00\",\"hrs\":13,\"mins\":42},\"etaLayover\":0,\"arrive\":{\"dateTime\":\"2019-09-29 13:41:31\",\"hrs\":13,\"mins\":41},\"depart\":{\"dateTime\":\"2019-09-29 13:58:22\",\"hrs\":13,\"mins\":58},\"atStop\":false,\"late\":true,\"status\":\"visited\",\"timestamp\":\"2019-09-29 13:41:31 +0000\"},\"delayed\":false},{\"arrive\":{\"dateTime\":\"2019-09-29 12:55:00\",\"hrs\":12,\"mins\":55},\"depart\":{\"dateTime\":\"2019-09-29 13:00:00\",\"hrs\":13,\"mins\":0},\"layover\":5,\"status\":null,\"timeZone\":\"America/New_York\",\"actualStatus\":3,\"duplicateCount\":0,\"eta\":{\"etaArrive\":{\"dateTime\":\"2019-09-29 14:25:00\",\"hrs\":14,\"mins\":25},\"etaDepart\":{\"dateTime\":\"2019-09-29 14:30:00\",\"hrs\":14,\"mins\":30},\"etaLayover\":5,\"arrive\":{\"dateTime\":\"2019-09-29 14:26:02\",\"hrs\":14,\"mins\":26},\"depart\":{\"dateTime\":\"2019-09-29 14:35:02\",\"hrs\":14,\"mins\":35},\"atStop\":false,\"late\":true,\"status\":\"visited\",\"timestamp\":\"2019-09-29 14:26:02 +0000\"},\"delayed\":false},{\"arrive\":{\"dateTime\":\"2019-09-29 13:20:00\",\"hrs\":13,\"mins\":20},\"depart\":{\"dateTime\":\"2019-09-29 13:45:00\",\"hrs\":13,\"mins\":45},\"layover\":25,\"status\":null,\"timeZone\":\"America/New_York\",\"actualStatus\":3,\"duplicateCount\":0,\"eta\":{\"etaArrive\":{\"dateTime\":\"2019-09-29 14:49:00\",\"hrs\":14,\"mins\":49},\"etaDepart\":{\"dateTime\":\"2019-09-29 15:14:00\",\"hrs\":15,\"mins\":14},\"etaLayover\":25,\"arrive\":{\"dateTime\":\"2019-09-29 14:49:03\",\"hrs\":14,\"mins\":49},\"depart\":{\"dateTime\":\"2019-09-29 14:54:03\",\"hrs\":14,\"mins\":54},\"atStop\":false,\"late\":true,\"status\":\"visited\",\"timestamp\":\"2019-09-29 14:49:03 +0000\"},\"delayed\":false},{\"arrive\":{\"dateTime\":\"2019-09-29 14:15:00\",\"hrs\":14,\"mins\":15},\"depart\":{\"dateTime\":\"2019-09-29 14:15:00\",\"hrs\":14,\"mins\":15},\"layover\":0,\"status\":null,\"timeZone\":\"America/New_York\",\"actualStatus\":3,\"duplicateCount\":0,\"eta\":{\"etaArrive\":{\"dateTime\":\"2019-09-29 15:17:00\",\"hrs\":15,\"mins\":17},\"etaDepart\":{\"dateTime\":\"2019-09-29 15:17:00\",\"hrs\":15,\"mins\":17},\"etaLayover\":0,\"arrive\":{\"dateTime\":\"2019-09-29 15:17:03\",\"hrs\":15,\"mins\":17},\"depart\":{\"dateTime\":\"2019-09-29 15:28:03\",\"hrs\":15,\"mins\":28},\"atStop\":false,\"late\":true,\"status\":\"visited\",\"timestamp\":\"2019-09-29 15:17:03 +0000\"},\"delayed\":false},{\"arrive\":{\"dateTime\":\"2019-09-29 15:30:00\",\"hrs\":15,\"mins\":30},\"depart\":{\"dateTime\":\"2019-09-29 16:30:00\",\"hrs\":16,\"mins\":30},\"layover\":60,\"status\":null,\"timeZone\":\"America/New_York\",\"actualStatus\":3,\"duplicateCount\":0,\"eta\":{\"etaArrive\":{\"dateTime\":\"2019-09-29 17:00:00\",\"hrs\":17,\"mins\":0},\"etaDepart\":{\"dateTime\":\"2019-09-29 18:00:00\",\"hrs\":18,\"mins\":0},\"etaLayover\":60,\"arrive\":{\"dateTime\":\"2019-09-29 16:49:05\",\"hrs\":16,\"mins\":49},\"depart\":{\"dateTime\":\"2019-09-29 17:37:36\",\"hrs\":17,\"mins\":37},\"atStop\":false,\"late\":true,\"status\":\"visited\",\"timestamp\":\"2019-09-29 16:49:05 +0000\"},\"delayed\":false},{\"arrive\":{\"dateTime\":\"2019-09-29 17:25:00\",\"hrs\":17,\"mins\":25},\"depart\":{\"dateTime\":\"2019-09-29 17:25:00\",\"hrs\":17,\"mins\":25},\"layover\":0,\"status\":null,\"timeZone\":\"America/New_York\",\"actualStatus\":3,\"duplicateCount\":0,\"eta\":{\"etaArrive\":{\"dateTime\":\"2019-09-29 18:55:00\",\"hrs\":18,\"mins\":55},\"etaDepart\":{\"dateTime\":\"2019-09-29 18:55:00\",\"hrs\":18,\"mins\":55},\"etaLayover\":0,\"arrive\":{\"dateTime\":\"2019-09-29 18:28:08\",\"hrs\":18,\"mins\":28},\"depart\":{\"dateTime\":\"2019-09-29 18:36:08\",\"hrs\":18,\"mins\":36},\"atStop\":false,\"late\":true,\"status\":\"visited\",\"timestamp\":\"2019-09-29 18:28:08 +0000\"},\"delayed\":false},{\"arrive\":{\"dateTime\":\"2019-09-29 18:10:00\",\"hrs\":18,\"mins\":10},\"depart\":{\"dateTime\":\"2019-09-29 18:25:00\",\"hrs\":18,\"mins\":25},\"layover\":15,\"status\":null,\"timeZone\":\"America/New_York\",\"actualStatus\":3,\"duplicateCount\":0,\"eta\":{\"etaArrive\":{\"dateTime\":\"2019-09-29 19:17:00\",\"hrs\":19,\"mins\":17},\"etaDepart\":{\"dateTime\":\"2019-09-29 19:32:00\",\"hrs\":19,\"mins\":32},\"etaLayover\":15,\"arrive\":{\"dateTime\":\"2019-09-29 19:11:08\",\"hrs\":19,\"mins\":11},\"depart\":{\"dateTime\":\"2019-09-29 19:12:09\",\"hrs\":19,\"mins\":12},\"atStop\":false,\"late\":true,\"status\":\"visited\",\"timestamp\":\"2019-09-29 19:11:08 +0000\"},\"delayed\":false},{\"arrive\":{\"dateTime\":\"2019-09-29 19:10:00\",\"hrs\":19,\"mins\":10},\"depart\":{\"dateTime\":\"2019-09-29 19:25:00\",\"hrs\":19,\"mins\":25},\"layover\":15,\"status\":null,\"timeZone\":\"America/New_York\",\"actualStatus\":3,\"duplicateCount\":0,\"eta\":{\"etaArrive\":{\"dateTime\":\"2019-09-29 20:00:00\",\"hrs\":20,\"mins\":0},\"etaDepart\":{\"dateTime\":\"2019-09-29 20:15:00\",\"hrs\":20,\"mins\":15},\"etaLayover\":15,\"arrive\":{\"dateTime\":\"2019-09-29 20:00:10\",\"hrs\":20,\"mins\":0},\"depart\":{\"dateTime\":\"2019-09-29 20:16:10\",\"hrs\":20,\"mins\":16},\"atStop\":false,\"late\":true,\"status\":\"visited\",\"timestamp\":\"2019-09-29 20:00:10 +0000\"},\"delayed\":false},{\"arrive\":{\"dateTime\":\"2019-09-29 20:25:00\",\"hrs\":20,\"mins\":25},\"depart\":{\"dateTime\":\"2019-09-29 20:35:00\",\"hrs\":20,\"mins\":35},\"layover\":10,\"status\":null,\"timeZone\":\"America/New_York\",\"actualStatus\":3,\"duplicateCount\":0,\"eta\":{\"etaArrive\":{\"dateTime\":\"2019-09-29 21:09:00\",\"hrs\":21,\"mins\":9},\"etaDepart\":{\"dateTime\":\"2019-09-29 21:19:00\",\"hrs\":21,\"mins\":19},\"etaLayover\":10,\"arrive\":{\"dateTime\":\"2019-09-29 21:09:11\",\"hrs\":21,\"mins\":9},\"depart\":{\"dateTime\":\"2019-09-29 21:21:41\",\"hrs\":21,\"mins\":21},\"atStop\":false,\"late\":true,\"status\":\"visited\",\"timestamp\":\"2019-09-29 21:09:11 +0000\"},\"delayed\":false},{\"arrive\":{\"dateTime\":\"2019-09-29 21:10:00\",\"hrs\":21,\"mins\":10},\"depart\":{\"dateTime\":\"2019-09-29 21:40:00\",\"hrs\":21,\"mins\":40},\"layover\":30,\"status\":null,\"timeZone\":\"America/New_York\",\"actualStatus\":3,\"duplicateCount\":0,\"eta\":{\"etaArrive\":{\"dateTime\":\"2019-09-29 21:52:00\",\"hrs\":21,\"mins\":52},\"etaDepart\":{\"dateTime\":\"2019-09-29 21:55:00\",\"hrs\":21,\"mins\":55},\"etaLayover\":3,\"arrive\":{\"dateTime\":\"2019-09-29 21:51:12\",\"hrs\":21,\"mins\":51},\"depart\":{\"dateTime\":\"2019-09-29 21:55:00\",\"hrs\":21,\"mins\":55},\"atStop\":false,\"late\":true,\"status\":\"visited\",\"timestamp\":\"2019-09-29 21:51:12 +0000\"},\"delayed\":false},{\"arrive\":{\"dateTime\":\"2019-09-29 22:35:00\",\"hrs\":22,\"mins\":35},\"depart\":{\"dateTime\":\"2019-09-29 22:35:00\",\"hrs\":22,\"mins\":35},\"layover\":0,\"status\":null,\"timeZone\":\"America/New_York\",\"actualStatus\":3,\"duplicateCount\":0,\"eta\":{\"etaArrive\":{\"dateTime\":\"2019-09-29 22:57:00\",\"hrs\":22,\"mins\":57},\"etaDepart\":{\"dateTime\":\"2019-09-29 22:57:00\",\"hrs\":22,\"mins\":57},\"etaLayover\":0,\"arrive\":{\"dateTime\":\"2019-09-29 22:57:14\",\"hrs\":22,\"mins\":57},\"depart\":{\"dateTime\":\"2019-09-29 23:02:14\",\"hrs\":23,\"mins\":2},\"atStop\":false,\"late\":true,\"status\":\"visited\",\"timestamp\":\"2019-09-29 22:57:14 +0000\"},\"delayed\":false},{\"arrive\":{\"dateTime\":\"2019-09-29 23:15:00\",\"hrs\":23,\"mins\":15},\"depart\":{\"dateTime\":\"2019-09-29 23:15:00\",\"hrs\":23,\"mins\":15},\"layover\":0,\"status\":null,\"timeZone\":\"America/New_York\",\"actualStatus\":3,\"duplicateCount\":0,\"eta\":{\"etaArrive\":{\"dateTime\":\"2019-09-29 23:31:00\",\"hrs\":23,\"mins\":31},\"etaDepart\":{\"dateTime\":\"2019-09-29 23:31:00\",\"hrs\":23,\"mins\":31},\"etaLayover\":0,\"arrive\":{\"dateTime\":\"2019-09-29 23:31:14\",\"hrs\":23,\"mins\":31},\"depart\":{\"dateTime\":\"2019-09-29 23:50:15\",\"hrs\":23,\"mins\":50},\"atStop\":false,\"late\":true,\"status\":\"visited\",\"timestamp\":\"2019-09-29 23:31:14 +0000\"},\"delayed\":false},{\"arrive\":{\"dateTime\":\"2019-09-30 00:45:00\",\"hrs\":0,\"mins\":45},\"depart\":{\"dateTime\":\"2019-09-30 01:45:00\",\"hrs\":1,\"mins\":45},\"layover\":60,\"status\":null,\"timeZone\":\"America/New_York\",\"actualStatus\":3,\"duplicateCount\":0,\"eta\":{\"etaArrive\":{\"dateTime\":\"2019-09-30 01:20:00\",\"hrs\":1,\"mins\":20},\"etaDepart\":{\"dateTime\":\"2019-09-30 02:19:00\",\"hrs\":2,\"mins\":19},\"etaLayover\":59,\"arrive\":{\"dateTime\":\"2019-09-30 01:20:00\",\"hrs\":1,\"mins\":20},\"depart\":{\"dateTime\":\"2019-09-30 02:19:00\",\"hrs\":2,\"mins\":19},\"atStop\":false,\"late\":true,\"status\":\"visited\",\"timestamp\":\"2019-09-30 01:20:00 +0000\"},\"delayed\":false},{\"arrive\":{\"dateTime\":\"2019-09-30 05:30:00\",\"hrs\":5,\"mins\":30},\"depart\":{\"dateTime\":\"2019-09-30 06:00:00\",\"hrs\":6,\"mins\":0},\"layover\":30,\"status\":null,\"timeZone\":\"America/New_York\",\"actualStatus\":3,\"duplicateCount\":0,\"eta\":{\"etaArrive\":{\"dateTime\":\"2019-09-30 05:36:00\",\"hrs\":5,\"mins\":36},\"etaDepart\":{\"dateTime\":\"2019-09-30 06:06:00\",\"hrs\":6,\"mins\":6},\"etaLayover\":30,\"arrive\":{\"dateTime\":\"2019-09-30 05:36:04\",\"hrs\":5,\"mins\":36},\"depart\":{\"dateTime\":\"2019-09-30 06:08:05\",\"hrs\":6,\"mins\":8},\"atStop\":false,\"late\":false,\"status\":\"visited\",\"timestamp\":\"2019-09-30 05:36:04 +0000\"},\"delayed\":false},{\"arrive\":{\"dateTime\":\"2019-09-30 08:30:00\",\"hrs\":8,\"mins\":30},\"depart\":{\"dateTime\":\"2019-09-30 08:30:00\",\"hrs\":8,\"mins\":30},\"layover\":0,\"status\":null,\"timeZone\":\"America/New_York\",\"actualStatus\":3,\"duplicateCount\":0,\"eta\":{\"etaArrive\":{\"dateTime\":\"2019-09-30 09:04:00\",\"hrs\":9,\"mins\":4},\"etaDepart\":{\"dateTime\":\"2019-09-30 09:04:00\",\"hrs\":9,\"mins\":4},\"etaLayover\":0,\"arrive\":{\"dateTime\":\"2019-09-30 09:04:00\",\"hrs\":9,\"mins\":4},\"depart\":null,\"atStop\":true,\"late\":true,\"status\":\"visited\",\"timestamp\":\"2019-09-30 09:04:00 +0000\"},\"delayed\":false}],\"route\":\"1076\",\"dir\":\"I\",\"journeyId\":\"GLI_1076\",\"linkName\":\"Atlanta_GA-New_York_NY\",\"duration\":{\"hrs\":23,\"mins\":20},\"multiDay\":false,\"depart\":\"Atlanta, GA\",\"arrival\":\"New York, NY\",\"live\":{\"vehicleId\":\"86506\",\"vehicle\":\"86506\",\"lat\":40.75695,\"lon\":-73.9905,\"bearing\":0,\"status\":\"1\",\"timestamp\":{\"dateTime\":\"2019-09-30 09:04:00\",\"hrs\":9,\"mins\":4},\"timeZone\":\"EDT\",\"geoLocation\":\"West 42nd Street, New York, New York County\",\"gpsProvider\":\"Icomera\"},\"duplicateCount\":0,\"dups\":null,\"started\":null,\"next\":null,\"prev\":null,\"active\":[{\"date\":\"2019-10-03\",\"linkDate\":\"10-03-2019\",\"journeyId\":\"GLI_1076\"},{\"date\":\"2019-10-04\",\"linkDate\":\"10-04-2019\",\"journeyId\":\"GLI_1076\"}]}],\"time\":\"2019-10-04 02:46:54 +0000\"}")
            expect(result.id).toBe('GLI_1076')
        })
    })
})